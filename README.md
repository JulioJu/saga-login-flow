# Saga Login Flow

> A login/register flow built with React & Redux Saga

[![Build Status](https://travis-ci.org/sotojuan/saga-login-flow.svg?branch=master)](https://travis-ci.org/sotojuan/saga-login-flow)

This application demonstrates what a React-based register/login workflow might look like with [Redux Saga](https://github.com/yelouafi/redux-saga).

It's based on Max Stoiber's [login-flow](https://github.com/mxstbr/login-flow), but uses Redux Saga instead of Redux Thunk to handle asynchronous actions.

All the saga stuff is [here](https://github.com/sotojuan/saga-login-flow/blob/master/app/sagas/index.js). The rest is regular React and Redux!

## Redux-saga vs Redux-thunx
* I use redux-saga even if:
    * redux-saga it's less downloaded than;
        redux-thunx (635,982 vs 2,286,269 downloads in the last month)
    * redux-thunx is explained on the official redux documentation
        (https://redux.js.org/docs/advanced/AsyncActions.html)

* Advantages to use redux-saga:
    * More updated (maybe hundreds commits the last year, while the last commit
        of redux-thunks was on juanuary 2017).
    * « Contrary to redux thunk, you don't end up in callback hell, you can test
        your asynchronous flows easily and your actions stay pure. »: =>
        Maybe redux-saga is better to understand how react and redux work for a
        newbie because the code isn't mix.
    * On https://react.rocks,
        (saga-login-flow](https://react.rocks/example/saga-login-flow)
        is pined as « Well Tested », contrary to
        [login-flow](https://react.rocks/example/login-flow)

## create-redux-app
* This application is generated thanks to the npm package `create-redux-app`,
    advise in the official documentation
    (https://reactjs.org/docs/installation.html)
* Please see file README2.md (official README generated by `create-redux-app`)

## Postcss
* I've run `yarn eject` because of some postcss packages.

### postcss.config.js
*   Create a file named `postcss.config.js` with content below doesn't work for
    postcss-import, contrary as they say on
    https://github.com/postcss/postcss#webpack. It seems to have a conflict
    between webpack.config.*.js and postcss.config.js (works if in
    webpack.config.*.js there isn't `ident: 'postcss'`, or works if in
    postcss.config.js we add only the plugin autoprefixer).

* onImport: function (files) founded at
    https://github.com/mxstbr/login-flow/blob/master/makewebpackconfig.js
```javascript
    'use strict';

    const autoprefixer = require('autoprefixer');
    module.exports = {
      plugins: [
        require('postcss-import')({ // Import all the css files...
          onImport: function(files) {
            console.log(files);
            files.forEach(this.addDependency); // ...and add dependecies from the main.css files to the other css files...
          }.bind(this) // ...so they get hot–reloaded when something changes...
        }),
        require('postcss-simple-vars')(), // ...then replace the variables...
        require('postcss-focus')(), // ...add a :focus to ever :hover...
        require('postcss-flexbugs-fixes'),
        autoprefixer({
          browsers: [
            '>1%',
            'last 4 versions',
            'Firefox ESR',
            'not ie < 9', // React doesn't support IE8 anyway
          ],
          flexbox: 'no-2009',
        }),
        require('postcss-reporter')({ // This plugin makes sure we get warnings in the console
          clearMessages: true
        }),
      ]
    }
```

## Authentication

Authentication happens in `app/auth/index.js`, using `fakeRequest.js` and `fakeServer.js`. `fakeRequest` is a fake `XMLHttpRequest` wrapper. `fakeServer` responds to the fake HTTP requests and pretends to be a real server, storing the current users in local storage with the passwords encrypted using `bcrypt`.

## Know problems
* In src/index.js,there is jsx lambda expressions. See
    https://github.com/palantir/tslint-react why it's not good.
    * In the lambda cause error
        `Warning: Cannot update during an existing state transition
        (such as within \`render\` or another component's constructor).
        Render methods should be a pure function of props and state;
        constructor side-effects are an anti-pattern, but can be moved to
        \`componentWillMount\`.`
    * But seems to be a good practice to use this syntax in this context (indeed
        we want render again the component when we go to the Route)

        (https://github.com/ReactTraining/react-router/blob/master/packages/react-router/docs/api/Redirect.md)
## Thanks

* [Max Stoiber](https://twitter.com/mxstbr) for the Login Flow idea.
* [Yassine Elouafi](https://github.com/yelouafi) for Redux Saga. Awesome!

## See also
* https://react.rocks/
* https://react.rocks/example/saga-login-flow
* https://react.rocks/example/login-flow
* https://github.com/sotojuan/saga-login-flow/ (especially the README.md)
* https://github.com/mxstbr/login-flow (especially the README.md)
* redux-logger displays lot of useful and understandable informations in the
    console.

<!-- vim: sw=2 ts=2 et:
-->

## License

MIT © [Juan Soto](https://juansoto.me)
